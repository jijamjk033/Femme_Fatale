<%- include('../layouts/userHeader.ejs') %>

    <!-- Quick view -->

    <main class="main">
        <section class="mt-50 mb-50">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <!-- Products display -->
                        <div class="row product-grid-3">
                            <!-- Product 1 display -->
                            <section class="section-padding">
                                <div class="container wow fadeIn animated">
                                    <div class="tab-content wow fadeIn animated" id="myTabContent">
                                        <div class="tab-pane fade show active" id="tab-one" role="tabpanel"
                                            aria-labelledby="tab-one">
                                            <div class="row product-grid-4">
                                                <% products.forEach((product)=> {
                                                    if(product.is_listed == true) { %>
                                                    <div class="col-lg-3 col-md-4 col-12 col-sm-6 mb-4 pointer">
                                                        <!-- Adjusted column and margin classes -->
                                                        <div class="product-cart-wrap mb-30">
                                                            <div class="product-img-action-wrap">
                                                                <div class="product-img product-img-zoom">
                                                                    <a href="/singleProduct/<%= product._id %>">
                                                                        <% if (product.image.length> 0) { %>
                                                                            <a href="/singleProduct/<%= product._id %>">
                                                                                <img width="90 px" height="310px"
                                                                                    class="default-img"
                                                                                    src="assets/images/Products/<%= product.image[0] %>"
                                                                                    alt="">
                                                                                <img width="90 px" height="310px"
                                                                                    class="hover-img"
                                                                                    src="assets/images/Products/<%= product.image[0] %>"
                                                                                    alt="">
                                                                            </a>
                                                                            <% } else { %>
                                                                                <a
                                                                                    href="/singleProduct/<%= product._id %>">
                                                                                    <img class="default-img"
                                                                                        src="https://dummyimage.com/450x300/dee2e6/6c757d.jpg"
                                                                                        alt="">
                                                                                </a>
                                                                                <% } %>
                                                                    </a>
                                                                </div>
                                                            </div>
                                                            <div class="product-content-wrap">
                                                                <div class="product-category">
                                                                    <!-- Replace this with your product category -->
                                                                    <a href="/singleProduct/<%= product._id %>">
                                                                        <%= product.category.name %>
                                                                    </a>
                                                                </div>
                                                                <h2><a href="/singleProduct/<%= product._id %>">
                                                                        <%= product.name %>
                                                                    </a></h2>
                                                                <!-- Replace this with your rating logic -->
                                                                <div class="rating-result"
                                                                    title="<%= product.rating_percentage %>">
                                                                    <span>
                                                                        <span>
                                                                            <%= product.rating_percentage %>
                                                                        </span>
                                                                    </span>
                                                                </div>
                                                                <div class="product-price">
                                                                    <!-- Replace this with your pricing logic -->
                                                                    <span>₹ <%= product.price %></span>
                                                                    <% if (product.old_price) { %>
                                                                        <span class="old-price">₹ <%= product.old_price
                                                                                %> </span>
                                                                        <% } %>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <% } }); %>
                            </section>
                        </div>
                    </div>
                </div>
                <!-- Pagination Controls -->
                <div class="d-flex justify-content-center">
                    <% if (products.length> 0) { %>
                        <ul class="pagination">
                            <% if (currentPage> 1) { %>
                                <li><a href="/shop?page=<%= currentPage - 1 %>">Previous</a></li>
                                <% } %>

                                    <% const totalPages=Math.ceil(products.length/ 12); %>
                                        <% for (let i=1; i <=totalPages; i++) { %>
                                            <li <% if (i===currentPage) { %>class="active"<% } %>>
                                                    <a class="text-primary" href="/shop?page=<%= i %>">
                                                        <%= i %>
                                                    </a>
                                            </li>
                                            <% } %>
                                                <% if (currentPage < totalPages) { %>
                                                    <li><a href="/shop?page=<%= currentPage + 1 %>">Next</a></li>
                                                    <% } %>
                        </ul>
                        <% } %>
                </div>
            </div>
        </section>
    </main>

    <%- include('../layouts/userFooter.ejs') %>